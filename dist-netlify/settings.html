<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - HC Initiatives Tracker</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <!-- Particle Grid Background -->
    <div class="particle-bg"></div>

    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="logo">
            <i data-lucide="layout-dashboard"></i>
            <span>HC Initiatives Tracker</span>
        </div>

        <a href="dashboard.html" class="nav-item">
            <i data-lucide="layout-dashboard"></i> <span class="menu-text">Dashboard Overview</span>
        </a>
        <a href="projects.html" class="nav-item">
            <i data-lucide="folder-kanban"></i> <span class="menu-text">Initiatives</span>
        </a>
        <a href="owners.html" class="nav-item">
            <i data-lucide="users"></i> <span class="menu-text">Owners</span>
        </a>
        <a href="analytics.html" class="nav-item">
            <i data-lucide="bar-chart-2"></i> <span class="menu-text">Analytic</span>
        </a>
        <a href="notifications.html" class="nav-item">
            <i data-lucide="bell"></i> <span class="menu-text">Notifications</span>
            <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
        </a>
        <a href="timeline.html" class="nav-item">
            <i data-lucide="calendar"></i> <span class="menu-text">Timeline</span>
        </a>
        <a href="approvals.html" class="nav-item" id="approvalsLink">
            <i data-lucide="check-circle"></i> <span class="menu-text">Approvals</span>
            <span id="approvalsBadge" class="notification-badge" style="display: none;">0</span>
        </a>
        <a href="user-management.html" class="nav-item">
            <i data-lucide="user-cog"></i> <span class="menu-text">User Management</span>
        </a>
        <a href="settings.html" class="nav-item active">
            <i data-lucide="settings"></i> <span class="menu-text">Setting</span>
        </a>

        <!-- Logout Button at Bottom -->
        <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
            <a href="#" onclick="confirmLogout(event)" class="nav-item" style="color: #ff0055;">
                <i data-lucide="log-out"></i> <span class="menu-text">Logout</span>
            </a>
        </div>
    </nav>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 10000; align-items: center; justify-content: center;">
        <div
            style="background: linear-gradient(135deg, rgba(21, 21, 34, 0.95), rgba(26, 31, 46, 0.95)); border-radius: 16px; max-width: 400px; width: 90%; padding: 30px; border: 1px solid rgba(255, 0, 85, 0.3); box-shadow: 0 20px 60px rgba(255, 0, 85, 0.4);">
            <h3 style="margin: 0 0 15px 0; font-size: 20px; color: white; text-align: center;">Confirm Logout</h3>
            <p style="margin: 0 0 25px 0; color: var(--text-muted); text-align: center;">Are you sure you want to
                logout?</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button onclick="proceedLogout()"
                    style="padding: 12px; background: linear-gradient(135deg, #ff0055, #ff8800); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600;">Yes,
                    Logout</button>
                <button onclick="closeLogoutModal()"
                    style="padding: 12px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content fade-in-up">
        <header style="margin-bottom: 30px;">
            <h1 class="gradient-text" style="font-size: 28px; margin-bottom: 5px;">Settings</h1>
            <p style="color: var(--text-muted); font-size: 14px;">Manage your application preferences and data</p>
        </header>

        <!-- Settings Sections -->
        <div style="display: flex; flex-direction: column; gap: 20px;">

            <!-- Data Management -->
            <div class="stat-card" style="padding: 25px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div
                        style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #0088ff, #00f2ea); display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="database" style="width: 20px; height: 20px; color: white;"></i>
                    </div>
                    <h2 style="margin: 0; font-size: 18px; color: white;">Data Management</h2>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button onclick="exportData()" class="btn"
                        style="padding: 12px 20px; background: linear-gradient(135deg, #0088ff, #00f2ea); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i data-lucide="download" style="width: 16px;"></i>
                        Export Data
                    </button>
                    <button onclick="importData()" class="btn"
                        style="padding: 12px 20px; background: linear-gradient(135deg, #a855f7, #ff0055); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i data-lucide="upload" style="width: 16px;"></i>
                        Import Data
                    </button>
                    <button onclick="clearData()" class="btn"
                        style="padding: 12px 20px; background: linear-gradient(135deg, #ff8800, #ffbf00); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i data-lucide="trash-2" style="width: 16px;"></i>
                        Clear All Data
                    </button>
                    <button onclick="resetToDefault()" class="btn"
                        style="padding: 12px 20px; background: linear-gradient(135deg, #00ff9d, #00f2ea); color: black; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i data-lucide="refresh-cw" style="width: 16px;"></i>
                        Reset to Default
                    </button>
                </div>

                <div id="dataInfo"
                    style="margin-top: 15px; padding: 12px; background: rgba(0, 136, 255, 0.1); border-radius: 6px; border-left: 3px solid #0088ff;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 5px;">Current Data Status
                    </div>
                    <div style="font-size: 14px; color: white;">Loading...</div>
                </div>
            </div>

            <!-- Menu Customization -->
            <div class="stat-card" style="padding: 25px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div
                        style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #00f2ea, #0088ff); display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="edit-3" style="width: 20px; height: 20px; color: white;"></i>
                    </div>
                    <h2 style="margin: 0; font-size: 18px; color: white;">Menu Customization</h2>
                </div>

                <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 20px;">Customize sidebar menu item
                    names</p>

                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Dashboard</span>
                        <input type="text" id="menuDashboard" value="Dashboard Overview"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuDashboard', 'Dashboard Overview')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Initiatives</span>
                        <input type="text" id="menuInitiatives" value="Initiatives"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuInitiatives', 'Initiatives')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Owners</span>
                        <input type="text" id="menuOwners" value="Owners"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuOwners', 'Owners')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Analytics</span>
                        <input type="text" id="menuAnalytics" value="Analytic"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuAnalytics', 'Analytic')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Notifications</span>
                        <input type="text" id="menuNotifications" value="Notifications"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuNotifications', 'Notifications')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Timeline</span>
                        <input type="text" id="menuTimeline" value="Timeline"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuTimeline', 'Timeline')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Settings</span>
                        <input type="text" id="menuSettings" value="Setting"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuSettings', 'Setting')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                    <div
                        style="display: grid; grid-template-columns: 150px 1fr auto; gap: 10px; align-items: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <span style="color: var(--text-muted); font-size: 13px;">User Management</span>
                        <input type="text" id="menuUserManagement" value="User Management"
                            style="padding: 8px 12px; background: rgba(21, 21, 34, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; font-size: 13px;">
                        <button onclick="resetMenuName('menuUserManagement', 'User Management')"
                            style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 4px; color: white; cursor: pointer; font-size: 12px;">Reset</button>
                    </div>
                </div>

                <button onclick="saveMenuNames()"
                    style="margin-top: 15px; width: 100%; padding: 12px; background: linear-gradient(135deg, #0088ff, #00f2ea); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600;">
                    Save Menu Names
                </button>
            </div>

            <!-- Display Preferences -->
            <div class="stat-card" style="padding: 25px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div
                        style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #a855f7, #ff0055); display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="palette" style="width: 20px; height: 20px; color: white;"></i>
                    </div>
                    <h2 style="margin: 0; font-size: 18px; color: white;">Display Preferences</h2>
                </div>

                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <!-- Theme Toggle -->
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Theme Mode</div>
                            <div style="font-size: 12px; color: var(--text-muted);" id="themeLabel">Dark Mode (Current)
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="themeToggle" checked onchange="handleThemeToggle()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Animations Toggle -->
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Animations</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Enable motion effects and
                                transitions</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="animationsToggle" checked onchange="toggleAnimations()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Compact Mode -->
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Compact Mode</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Reduce spacing and padding</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="compactModeToggle" onchange="toggleCompactMode()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Notification Settings -->
            <div class="stat-card" style="padding: 25px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div
                        style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #ff8800, #ffbf00); display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="bell" style="width: 20px; height: 20px; color: white;"></i>
                    </div>
                    <h2 style="margin: 0; font-size: 18px; color: white;">Notification Settings</h2>
                </div>

                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Overdue Alerts</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Show notifications for overdue
                                initiatives</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="overdueAlerts" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Upcoming Deadlines</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Alert for deadlines within 7 days
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="upcomingAlerts" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                        <div>
                            <div style="font-size: 14px; color: white; margin-bottom: 4px;">Progress Updates</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Notify on high progress milestones
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="progressAlerts" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- About -->
            <div class="stat-card" style="padding: 25px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div
                        style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #00ff9d, #00f2ea); display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="info" style="width: 20px; height: 20px; color: black;"></i>
                    </div>
                    <h2 style="margin: 0; font-size: 18px; color: white;">About</h2>
                </div>

                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div
                        style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <span style="color: var(--text-muted); font-size: 14px;">Application</span>
                        <span style="color: white; font-size: 14px; font-weight: 600;">HC Initiatives Tracker</span>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <span style="color: var(--text-muted); font-size: 14px;">Version</span>
                        <span style="color: white; font-size: 14px; font-weight: 600;">1.0.0</span>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <span style="color: var(--text-muted); font-size: 14px;">Last Updated</span>
                        <span style="color: white; font-size: 14px; font-weight: 600;" id="lastUpdated">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                        <span style="color: var(--text-muted); font-size: 14px;">Organization</span>
                        <span style="color: white; font-size: 14px; font-weight: 600;">PT Perkebunan Nusantara
                            III</span>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Hidden file input for import -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <!-- Scripts -->
    <script src="js/rbac.js"></script>
    <script src="js/data.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/logout.js"></script>
    <script>
        // Update data info
        function updateDataInfo() {
            const initiatives = JSON.parse(localStorage.getItem('initiatives') || 'null');
            const dataInfo = document.getElementById('dataInfo');

            if (initiatives) {
                dataInfo.innerHTML = `
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 5px;">Current Data Status</div>
                    <div style="font-size: 14px; color: white;">${initiatives.length} initiatives stored in local storage</div>
                `;
            } else {
                dataInfo.innerHTML = `
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 5px;">Current Data Status</div>
                    <div style="font-size: 14px; color: white;">Using default mock data (${MOCK_INITIATIVES.length} initiatives)</div>
                `;
            }
        }

        // Export data
        function exportData() {
            const initiatives = JSON.parse(localStorage.getItem('initiatives') || 'null') || MOCK_INITIATIVES;
            const dataStr = JSON.stringify(initiatives, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `hc-initiatives-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            alert('Data exported successfully!');
        }

        // Import data
        function importData() {
            const fileInput = document.getElementById('fileInput');
            fileInput.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        localStorage.setItem('initiatives', JSON.stringify(data));
                        alert(`Successfully imported ${data.length} initiatives!`);
                        updateDataInfo();
                        location.reload();
                    } catch (error) {
                        alert('Error importing data. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            };
            fileInput.click();
        }

        // Clear data
        function clearData() {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                localStorage.removeItem('initiatives');
                alert('All data cleared. Page will reload with default data.');
                updateDataInfo();
                location.reload();
            }
        }

        // Reset to default
        function resetToDefault() {
            if (confirm('Reset all data to default mock data?')) {
                localStorage.setItem('initiatives', JSON.stringify(MOCK_INITIATIVES));
                alert('Data reset to default. Page will reload.');
                location.reload();
            }
        }

        // Toggle animations
        function toggleAnimations() {
            const enabled = document.getElementById('animationsToggle').checked;
            document.body.style.setProperty('--animation-duration', enabled ? '0.3s' : '0s');
            localStorage.setItem('animationsEnabled', enabled);
        }

        // Toggle compact mode
        function toggleCompactMode() {
            const enabled = document.getElementById('compactModeToggle').checked;
            if (enabled) {
                document.body.style.setProperty('--spacing-md', '12px');
                document.body.style.setProperty('--spacing-lg', '16px');
            } else {
                document.body.style.setProperty('--spacing-md', '20px');
                document.body.style.setProperty('--spacing-lg', '30px');
            }
            localStorage.setItem('compactMode', enabled);
        }

        // Load saved preferences
        function loadPreferences() {
            const animationsEnabled = localStorage.getItem('animationsEnabled') !== 'false';
            const compactMode = localStorage.getItem('compactMode') === 'true';

            document.getElementById('animationsToggle').checked = animationsEnabled;
            document.getElementById('compactModeToggle').checked = compactMode;

            if (!animationsEnabled) toggleAnimations();
            if (compactMode) toggleCompactMode();
        }

        // Menu Customization Functions
        function saveMenuNames() {
            const menuNames = {
                dashboard: document.getElementById('menuDashboard').value.trim(),
                initiatives: document.getElementById('menuInitiatives').value.trim(),
                owners: document.getElementById('menuOwners').value.trim(),
                analytics: document.getElementById('menuAnalytics').value.trim(),
                notifications: document.getElementById('menuNotifications').value.trim(),
                timeline: document.getElementById('menuTimeline').value.trim(),
                settings: document.getElementById('menuSettings').value.trim(),
                userManagement: document.getElementById('menuUserManagement').value.trim()
            };
            localStorage.setItem('customMenuNames', JSON.stringify(menuNames));

            // Apply changes immediately to current page
            if (window.applyCustomMenuNames) {
                window.applyCustomMenuNames();
            }

            alert('Menu names saved successfully! Changes will apply across all pages.');
        }

        function applyMenuNames() {
            const savedNames = JSON.parse(localStorage.getItem('menuNames') || 'null');
            if (!savedNames) return;

            // Update menu items on current page
            const menuItems = document.querySelectorAll('.nav-item .menu-text');
            menuItems.forEach(item => {
                const parent = item.closest('.nav-item');
                const href = parent.getAttribute('href');

                if (href.includes('dashboard')) item.textContent = savedNames.dashboard;
                else if (href.includes('projects')) item.textContent = savedNames.initiatives;
                else if (href.includes('owners')) item.textContent = savedNames.owners;
                else if (href.includes('analytics')) item.textContent = savedNames.analytics;
                else if (href.includes('notifications')) item.textContent = savedNames.notifications;
                else if (href.includes('timeline')) item.textContent = savedNames.timeline;
                else if (href.includes('settings')) item.textContent = savedNames.settings;
            });
        }

        function resetMenuName(inputId, defaultValue) {
            document.getElementById(inputId).value = defaultValue;
        }

        function loadMenuNames() {
            const savedNames = JSON.parse(localStorage.getItem('menuNames') || 'null');
            if (savedNames) {
                document.getElementById('menuDashboard').value = savedNames.dashboard || 'Dashboard Overview';
                document.getElementById('menuInitiatives').value = savedNames.initiatives || 'Initiatives';
                document.getElementById('menuOwners').value = savedNames.owners || 'Owners';
                document.getElementById('menuAnalytics').value = savedNames.analytics || 'Analytic';
                document.getElementById('menuNotifications').value = savedNames.notifications || 'Notifications';
                document.getElementById('menuTimeline').value = savedNames.timeline || 'Timeline';
                document.getElementById('menuSettings').value = savedNames.settings || 'Setting';
            }
        }

        // Update last updated date
        document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('id-ID', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Initialize
        updateDataInfo();
        loadPreferences();
        loadMenuNames();
        applyMenuNames();
        lucide.createIcons();

        // Theme Toggle Handler
        function handleThemeToggle() {
            const toggle = document.getElementById('themeToggle');
            const label = document.getElementById('themeLabel');
            const theme = toggle.checked ? 'dark' : 'light';

            setTheme(theme);
            label.textContent = theme === 'dark' ? 'Dark Mode (Current)' : 'Light Mode (Current)';
        }

        // Initialize theme toggle
        setTimeout(() => {
            const currentTheme = getTheme();
            const toggle = document.getElementById('themeToggle');
            const label = document.getElementById('themeLabel');

            if (toggle && label) {
                toggle.checked = (currentTheme === 'dark');
                label.textContent = currentTheme === 'dark' ? 'Dark Mode (Current)' : 'Light Mode (Current)';
            }
        }, 100);
    </script>

    <!-- Toggle Switch Styles -->
    <style>
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: 0.3s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked+.toggle-slider {
            background: linear-gradient(135deg, #0088ff, #00f2ea);
        }

        input:checked+.toggle-slider:before {
            transform: translateX(24px);
        }

        input:disabled+.toggle-slider {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
<script>
    (function() {
        var expiration = new Date("2026-01-07T09:58:36Z").getTime();
        var now = new Date().getTime();
        if (now > expiration) {
            document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#f8f9fa;color:#dc3545;font-family:sans-serif;flex-direction:column;text-align:center;">' +
                '<h1 style="font-size:3rem;margin-bottom:1rem;">Link Expired</h1>' +
                '<p style="font-size:1.5rem;">This shared access link has expired.</p>' +
                '</div>';
            throw new Error("Session Expired");
        } else {
            console.log("Session valid until: " + new Date(expiration).toLocaleString());
        }
    })();
</script>
</body>

</html>
